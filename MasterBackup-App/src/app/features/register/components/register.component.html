<div class="d-flex flex-column flex-root" id="kt_app_root">
  <div class="d-flex flex-column flex-lg-row flex-column-fluid">
    <!-- Left side - Branding -->
    <div class="d-flex flex-lg-row-fluid w-lg-50 bgi-size-cover bgi-position-center order-1 order-lg-1" 
         style="background-image: url(assets/media/misc/auth-bg.png)">
      <div class="d-flex flex-column flex-center py-7 py-lg-15 px-5 px-md-15 w-100">
        <a href="/" class="mb-12">
          <img alt="Logo" src="assets/media/logos/custom-1.png" class="h-60px h-lg-75px" />
        </a>
        
        <h1 class="d-none d-lg-block text-white fs-2qx fw-bolder text-center mb-7">
          Sistema de Respaldos Multi-Tenant
        </h1>
        
        <div class="d-none d-lg-block text-white fs-base text-center">
          Cree su cuenta y comience a proteger sus datos con nuestra plataforma segura y escalable.
        </div>
      </div>
    </div>

    <!-- Right side - Registration Form -->
    <div class="d-flex flex-center w-lg-50 p-10">
      <div class="card rounded-3 w-md-550px">
        <div class="card-body p-10 p-lg-15">
          <!-- Header -->
          <div class="mb-10 text-center">
            <h1 class="text-gray-900 fw-bolder mb-3">Crear Cuenta</h1>
            <div class="text-gray-500 fw-semibold fs-6">
              Complete el formulario para crear su cuenta
            </div>
          </div>

          <!-- Success Message -->
          <div *ngIf="successMessage" class="alert alert-success d-flex align-items-center mb-10">
            <i class="ki-duotone ki-check-circle fs-2hx text-success me-4">
              <span class="path1"></span>
              <span class="path2"></span>
            </i>
            <div class="d-flex flex-column">
              <span class="fw-semibold">{{ successMessage }}</span>
            </div>
          </div>

          <!-- Error Message -->
          <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center mb-10">
            <i class="ki-duotone ki-information-5 fs-2hx text-danger me-4">
              <span class="path1"></span>
              <span class="path2"></span>
              <span class="path3"></span>
            </i>
            <div class="d-flex flex-column">
              <span class="fw-semibold">{{ errorMessage }}</span>
            </div>
          </div>

          <!-- Registration Form -->
          <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="form w-100">
            <!-- Tenant Name -->
            <div class="fv-row mb-8">
              <label class="form-label fs-6 fw-bolder text-gray-900 required">Nombre de la Organización</label>
              <input 
                type="text" 
                class="form-control form-control-lg form-control-solid" 
                formControlName="tenantName"
                placeholder="Ej: Mi Empresa S.A."
                autocomplete="organization" />
            </div>

            <!-- First Name & Last Name -->
            <div class="row g-3 mb-8">
              <div class="col-md-6">
                <label class="form-label fs-6 fw-bolder text-gray-900 required">Nombre</label>
                <input 
                  type="text" 
                  class="form-control form-control-lg form-control-solid" 
                  formControlName="firstName"
                  placeholder="Ej: Juan"
                  autocomplete="given-name" />
              </div>

              <div class="col-md-6">
                <label class="form-label fs-6 fw-bolder text-gray-900 required">Apellido</label>
                <input 
                  type="text" 
                  class="form-control form-control-lg form-control-solid" 
                  formControlName="lastName"
                  placeholder="Ej: Pérez"
                  autocomplete="family-name" />
              </div>
            </div>

            <!-- Email -->
            <div class="fv-row mb-8">
              <label class="form-label fs-6 fw-bolder text-gray-900 required">Correo Electrónico</label>
              <input 
                type="email" 
                class="form-control form-control-lg form-control-solid" 
                formControlName="email"
                placeholder="usuario@ejemplo.com"
                autocomplete="email" />
            </div>

            <!-- Password -->
            <div class="fv-row mb-4">
              <label class="form-label fs-6 fw-bolder text-gray-900 required">Contraseña</label>
              <div class="position-relative">
                <input 
                  [type]="showPassword ? 'text' : 'password'" 
                  class="form-control form-control-lg form-control-solid" 
                  formControlName="password"
                  placeholder="Mínimo 8 caracteres"
                  autocomplete="new-password" />
                <button 
                  type="button" 
                  class="btn btn-icon btn-sm btn-active-color-primary position-absolute end-0 top-50 translate-middle-y me-2"
                  (click)="togglePasswordVisibility()">
                  <i class="ki-duotone ki-eye{{ showPassword ? '-slash' : '' }} fs-2">
                    <span class="path1"></span>
                    <span class="path2"></span>
                    <span class="path3" *ngIf="showPassword"></span>
                  </i>
                </button>
              </div>
              
              <!-- Password Strength Indicator -->
              <div *ngIf="registerForm.get('password')?.value" class="d-flex align-items-center mt-3">
                <div class="flex-grow-1 bg-secondary bg-active-state-light rounded h-5px me-3">
                  <div 
                    class="rounded h-5px" 
                    [ngClass]="getPasswordStrengthColor()"
                    [style.width.%]="getPasswordStrength() * 25"></div>
                </div>
                <div class="fw-semibold text-muted fs-7">{{ getPasswordStrengthText() }}</div>
              </div>
              
              <div class="text-muted fs-7 mt-2">
                Use 8 o más caracteres con mayúsculas, minúsculas y números.
              </div>
            </div>

            <!-- Confirm Password -->
            <div class="fv-row mb-8">
              <label class="form-label fs-6 fw-bolder text-gray-900 required">Confirmar Contraseña</label>
              <div class="position-relative">
                <input 
                  [type]="showConfirmPassword ? 'text' : 'password'" 
                  class="form-control form-control-lg form-control-solid" 
                  formControlName="confirmPassword"
                  placeholder="Repita su contraseña"
                  autocomplete="new-password" />
                <button 
                  type="button" 
                  class="btn btn-icon btn-sm btn-active-color-primary position-absolute end-0 top-50 translate-middle-y me-2"
                  (click)="toggleConfirmPasswordVisibility()">
                  <i class="ki-duotone ki-eye{{ showConfirmPassword ? '-slash' : '' }} fs-2">
                    <span class="path1"></span>
                    <span class="path2"></span>
                    <span class="path3" *ngIf="showConfirmPassword"></span>
                  </i>
                </button>
              </div>
            </div>

            <!-- Two Factor Authentication -->
            <div class="fv-row mb-10">
              <label class="form-check form-check-custom form-check-solid">
                <input 
                  class="form-check-input" 
                  type="checkbox" 
                  formControlName="enableTwoFactor" />
                <span class="form-check-label fw-semibold text-gray-700 fs-base ms-1">
                  Habilitar autenticación de dos factores (2FA)
                </span>
              </label>
              <div class="text-muted fs-7 mt-2">
                Le enviaremos un código por correo cada vez que inicie sesión para mayor seguridad.
              </div>
            </div>

            <!-- Submit Button -->
            <div class="d-grid mb-10">
              <button 
                type="submit" 
                class="btn btn-primary btn-lg"
                [disabled]="registerForm.invalid || isSubmitting">
                <span *ngIf="!isSubmitting">Crear Cuenta</span>
                <span *ngIf="isSubmitting" class="indicator-label">
                  Por favor espere...
                  <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                </span>
              </button>
            </div>

            <!-- Login Link -->
            <div class="text-gray-500 text-center fw-semibold fs-6">
              ¿Ya tienes una cuenta?
              <a routerLink="/login" class="link-primary fw-bold">Iniciar Sesión</a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
